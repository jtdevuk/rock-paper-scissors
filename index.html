<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
        <div class="center-text">
            <h1>Rock Paper Scissors</h1>
        </div>
        <div class="center-text">
            <p>Test your luck against the computer player in this classic game. Best score out of five will win the round!</p>
        </div>
        <div id="score" class="center-text">
            <div>
                <h2>Player Score:</h2>
            </div>
            <div id="player">
                <h2>0</h2>
            </div>
            <div>
                <h2>Computer Score:</h2>
            </div>
            <div id="computer">
                <h2>0</h2>
            </div>
        </div>
        <div id="choices">
            <img src="images/rock.svg" alt="rock" class="pic" id="rock">
            <img src="images/paper.svg" alt="paper" class="pic" id="paper">
            <img src="images/scissors.svg" alt="scissors" class="pic" id="scissors">
        </div>

    </body>
    <script>           
                
        let computerPlay = function() {
            let result = Math.floor(Math.random() * 3 );
        if (result == 0) {
            return "rock";        
        } else if (result == 1) {
            return "paper";            
        } else {
            return "scissors";
            }
        }
        
        let rounds = 0;
        let playerScore = 0;
        let computerScore = 0;        

        function game(playerSelection) { 

            playRound(playerSelection, computerPlay());

            function playRound(playerSelection, computerSelection) {

                const playerLowerCase = playerSelection.toLowerCase();
                
                let roundWinner;
                
                if (playerLowerCase == "rock") {
                    if (computerSelection == "rock") {
                        roundWinner = "Draw! You both chose Rock";
                    } else if (computerSelection == "paper") {
                        roundWinner = "You lose! Paper beats Rock";
                        computerScore += 1;
                        updateComputerTotal();
                        
                    } else {                            
                        roundWinner = "You win! Rock beats Scissors!"
                        playerScore+= 1;
                        updatePlayerTotal();                        
                    }

                } else if (playerLowerCase == "paper") {
                    if (computerSelection == "paper") {
                        roundWinner = "Draw! you both chose Paper";
                    } else if (computerSelection == "scissors") {
                        roundWinner = "You lose! Scissors beats Paper";
                        computerScore += 1;
                        updateComputerTotal();
                    } else {                            
                        roundWinner = "You win! Paper beats Rock!"
                        playerScore+=1;
                        updatePlayerTotal();                        
                            
                    }

                } else if (playerLowerCase == "scissors") {
                    if (computerSelection == "scissors") {
                        roundWinner = "Draw! you both chose Scissors";
                    } else if (computerSelection == "rock") {
                        roundWinner = "You lose! Rock beats Scissors";
                        computerScore += 1;
                        updateComputerTotal();
                    } else {                            
                        roundWinner = "You win! Scissors beats Paper!"
                        playerScore+=1;
                        updatePlayerTotal();                            
                    }
                }                             
            }
            
            rounds += 1;
            
            if (rounds == 5) {

                const container = document.querySelector('#score')
                const message = document.createElement('div');
                message.setAttribute('id', 'message-div');
                
                if (playerScore >= 3) {
                    message.textContent = `Congratulations! you won a total of ${playerScore} games and are the round winner.`

                    console.log(`Congratulations! you won a total of ${playerScore} games and are the round winner.`)
                } else {
                    message.textContent = `Sorry, but you only won ${playerScore} games and you lost this round. Better luck next time!`
                    console.log(`Sorry, but you only won ${playerScore} games and you lost this round. Better luck next time!`)            
                }
                rounds = 0;

               
                container.after(message);
                
            }
        
        } 
        
        function updateComputerTotal(){
            const score = document.querySelector('#computer');
            score.innerHTML = `<h2>${computerScore}</h2>`;
        }

        function updatePlayerTotal(){
            const score = document.querySelector('#player');
            score.innerHTML = `<h2>${playerScore}</h2>`;
        }

        

        function scale(e) {
            this.classList.toggle('enlarge');            
        }

    const pics = document.querySelectorAll('.pic');
    const rock = document.querySelector('#rock');
    const paper = document.querySelector('#paper');
    const scissors = document.querySelector('#scissors');
    
    pics.forEach(pic => pic.addEventListener('mouseover', scale));
    pics.forEach(pic => pic.addEventListener('mouseleave', scale));     
    
    rock.addEventListener("click", function() { // need to create a foreach function to call game and pass in the id attribute of each image - but how?        
            game("rock");
        });   
      
    paper.addEventListener("click", function() {
        game("paper");
    });

    scissors.addEventListener("click", function() {
        game("scissors");
    });

    </script>
</html>